# Health Service

The HealthService is an app component that is running along other components like GameService and ResultWorker on the compute cluster. It provides a REST API that is being called by Azure Front Door to determine the health of a stamp (region). Unlike basic liveness probes, which are present on every API, health service is a more complex component which reflects the state of dependencies, in addition to its own.

![HealthService conceptual diagram](/docs/media/health-service-high-level.png)

The idea is, first of all, if the cluster itself is down, the health service won't respond at all. When the service is up and running, it performs periodic checks against various components of the solution:

- It attempts to do a simple query against Cosmos DB
- It attempts to send a message to Event Hub (the message will be filtered out by the background worker)
- It looks up a state file on the storage account. This file can be used to turn off a region, even while the other checks are still working ok.

All health check results are cached in memory for a configurable number of seconds (by default 10) so that not every call to the API results in backend calls. While this does add a small potential latency in detecting outages, it also reduces the additional cluster load generated by health checks.

[Code documentation](/src/app/AlwaysOn.HealthService/README.md)

---
[AlwaysOn - Full List of Documentation](/docs/README.md)
